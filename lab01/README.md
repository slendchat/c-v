# **Лабораторная работа №1. Виртуальный сервер**
## **Информация о студенте**

**Имя и фамилия:** Mamaliga Artur
**Группа:** I2302
**Дата выполнения:** 02.10.2025

---

## **Описание задачи**

В данной лабораторной работе рассматривается процесс виртуализации операционной системы, а также установка и настройка виртуального HTTP-сервера с использованием QEMU. В ходе выполнения работы устанавливается ОС Debian, настраивается веб-сервер Apache, СУБД MariaDB, PHP и CMS Drupal. Также рассматриваются базовые операции администрирования серверов.

---

## **Описание выполнения работы**
### Cоздание структуры папок и дискового образа

1. Создана папка `lab01`:
    
    ```
    mkdir lab01
    ```
    
2. В папке `lab01` создана папка `dvd` и файл `readme.md`:
    
    ```
    mkdir lab01/dvd
    touch lab01/readme.md
    ```
    
3. В папку `dvd` перемещен образ `debian.iso`:
    
    ```
    mv debian.iso lab01/dvd/
    ```

![alt text]({2B277861-39B8-47AB-9AE8-E239EFF5EEB7}.png)
### Установка Debian в виртуальную машину

Скачиваю дистрибутив Debian на Ubuntu 24.04 LTS при помощи команды wget
```bash
wget https://cdimage.debian.org/debian-cd/current/amd64/iso-dvd/debian-12.9.0-amd64-DVD-1.iso
```

![alt text]({823DAC8C-8072-4EE7-9E9F-6A9C65359F24}.png)

Далее устанавливаю qemu

```bash
sudo apt install qemu-system
```


Я создаю образ диска для виртуальной машины размером 8 ГБ в папке `lab01`, используя утилиту `qemu-img`. Я выбираю формат `qcow2` и помещаю этот образ в указанную папку через консоль. 
```bash
qemu-img create -f qcow2 debian.qcow2 8G
```

![alt text]({5A065C1F-3F33-4D14-A5B1-6BE4DDDF36EF}.png)

ввожу 
```bash
qemu-system-x86_64 -hda debian.qcow2 -cdrom dvd/debian.iso -boot d -m 2G 
```

и открывается окно qemu:
![alt text]({6FB70A32-34FC-40B2-854F-497B3F245790}.png)

Я устанавливаю ОС Debian, указывая параметры установки: я задаю хостовое имя `debian.localhost`, создаю пользователя под именем `user`, и назначаю ему пароль `password`.
![alt text]({B75FD5F9-0263-4A38-A6EE-0EBB834F8A84} 1.png)
![alt text]({D51824A6-E049-4A56-80E3-3A263AC7DE65}.png)

Я выбрал пункт `All files in one partition (recommended for new users)`. Этот вариант создаёт одну общую партицию для всех данных, что удобно и рекомендуется для новых пользователей.
![alt text]({46673C1E-6CFA-4F68-8888-BCC12CDE59D7}.png)

процесс установки
![alt text]({614773E9-C810-4F1A-B06D-C2A894B5ABDB}.png)

### Запуск виртуальной машины и настройка сети

```bash
qemu-system-x86_64 -hda debian.qcow2 -m 2G -smp 2 -device e1000,netdev=net0 \
-netdev user,id=net0,hostfwd=tcp::1080-:80,hostfwd=tcp::1022-:22
```
![alt text]({95B9FF53-5E2F-4DCC-B7E4-3C661896DF86}.png)
### Установка LAMP
```bash
su
apt update -y
apt install -y apache2 php libapache2-mod-php php-mysql mariadb-server mariadb-client unzip
````
![alt text]({E03A039C-26C4-4CCE-9651-3659C6E4B531} 1.png)

### Установка PhpMyAdmin и Drupal
```bash
wget https://files.phpmyadmin.net/phpMyAdmin/5.2.2/phpMyAdmin-5.2.2-all-languages.zip
wget https://ftp.drupal.org/files/projects/drupal-11.1.1.zip
```

![alt text]({0153BA72-B61B-4B53-81FE-35AAE8653F9E}.png)
![alt text]({DF99DA37-7649-44D6-9BA5-BBB69804302E}.png)

Распаковка файлов:
```bash
mkdir /var/www
unzip phpMyAdmin-5.2.2-all-languages.zip -d /var/www/
mv /var/www/phpMyAdmin-5.2.2-all-languages /var/www/phpmyadmin
unzip drupal-11.1.1.zip -d /var/www/
mv /var/www/drupal-11.1.1 /var/www/drupal
```

![alt text]({805A303F-A804-4B0C-8490-0D3BDF84AB21}.png)

### Настройка базы данных для Drupal

![alt text]({BB47F58F-D588-4C36-9A8A-FD21D2A33526}.png)

### Настройка виртуальных хостов Apache

Создание файла `/etc/apache2/sites-available/01-phpmyadmin.conf`:
![alt text]({BEA33B23-524F-4320-9C35-709F79244563}.png)

Создание файла `/etc/apache2/sites-available/02-drupal.conf`:
![alt text]({B2BF35E7-6FD1-4FAA-843F-7C169EDB9728}.png)

### Включение конфигураций и перезапуск Apache

![alt text]({A13307B4-5218-4B7B-8430-BFEBD2E8CF8E}.png)

Добавление записей в `/etc/hosts`:
```bash
echo "127.0.0.1 phpmyadmin.localhost" >> /etc/hosts
echo "127.0.0.1 drupal.localhost" >> /etc/hosts
```

### Запуск и тестирование
![alt text]({61510792-EB0A-4B8C-9213-70CF2B64AC23}.png)
Выводится полная информация о системе
ОС, хостнэйм, версия ядра, версия сборки ядра, дистрибутив, архитектура, полное название операционной системы.

Перезагрузка вебсервера происходит при помощи рестрарта его сервиса 
![alt text]({DA7DC786-9C00-43B3-96A9-FC8695BE2EAE}.png)

### Результат
Пример доступности сайтов
`http://drupal.localhost:1080`
`http://phpmyadmin.localhost:1080`

![alt text]({AAC6BAA8-71D5-4CE7-8274-54A830EE1AC9}.png)
упсс...
![alt text]({81CFD541-9EE0-4DAC-B8B7-77B0341BA8BA}.png)


![alt text](Pasted image 20250210161741.png)
![alt text]({5D9769B4-6B8D-4578-8F5F-82F9D0CF8CC7}.png)

# **Ответы на поставленные вопросы**
1. **Как скачать файл через** wget?

  ```bash
   wget <URL>
   ```

2. **Зачем необходимо создавать для каждого сайта свою базу и своего пользователя?**

- Для разделения данных разных сайтов. Также это способствует изоляции данных, логическое разделение упрощает их управление, упращает масштабируемость и повышает производительность. Отдельные пользователи это один из шагов к обеспечению защиты своих серверов.

3. **Как поменять доступ к системе управления БД на порт `1234`?**

- В файле `/etc/mysql/my.cnf изменить `port = 1234`.

4. **Какие преимущества дает виртуализация?**

- Изолированное тестирование, экономное, контролируемое и эффективное распределение ресурсов, масштабируемость.

5. **Почему важно настроить время?**

- Для корректности логов, работы сертификатов, синхронизации и бэкапов, корректность взаимодействия с другими серверами.

6. **Сколько места занимает виртуальный диск?**
```bash  
Artur.Mamaliga@LP-PF224A3D UCRT64 ~/lab01
$ du -sh debian.qcow2
3.3G    debian.qcow2	 
```


7. **Какие есть рекомендации по разбиению диска для серверов? Почему рекомендуется так разбивать диск?**

Для обычных задач я не разбиваю каким то особым образом диски, а оставляю все по стандарту, маунт все на / для простых решений этого более чем достаточно, разбивка диска же зависит от конкретных задач. Если важны логи и их очень много и они могут забить систему которая критическая, то тогда наверное лучше замаунтить /var  отдельно. В целом идея такая, что если что то постоянно растет и ему может понадобиться место лучше это положить в отдельную партицию потому что нарастить размер отдельной партиции проще чем / (рута), который наживаю не заэкстендишь. Но мое мнение на данный счет пока, что это зависит сугубо от ситуации.

# **Вывод**

В данной лабораторной работе были освоены навыки по настройке виртуального сервера с использованием QEMU. Были рассмотрены основные этапы установки операционной системы Debian, конфигурирования веб-сервера Apache и развертывания CMS Drupal.

Благодаря использованию виртуализации удалось:

- Создать изолированное окружение для тестирования;

- Эффективно управлять ресурсами хостовой машины;

- Опробовать настройку сетевого взаимодействия внутри виртуальной машины.


Настроенная среда позволит легко разворачивать и тестировать веб-приложения в безопасной и управляемой среде. В ходе работы были даны ответы на важные вопросы, связанные с администрированием веб-серверов и баз данных. Результаты данной лабораторной работы могут быть использованы в будущих задачах по серверному администрированию и DevOps.